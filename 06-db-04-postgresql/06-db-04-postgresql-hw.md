Домашнее задание к занятию 4. «PostgreSQL»

Задача 1
---
Используя Docker, поднимите инстанс PostgreSQL (версию 13). Данные БД сохраните в volume.

![Снимок300](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/5fe8555b-04af-48d3-a258-00dab9ed89d8)
![Снимок301](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/3345729d-9074-43af-94d9-32a574159e92)


Подключитесь к БД PostgreSQL, используя psql.
![Снимок302](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/0e5d1826-e9c3-440e-8a37-c949d750212f)

Воспользуйтесь командой \? для вывода подсказки по имеющимся в psql управляющим командам.

Найдите и приведите управляющие команды для:

вывода списка БД,

\l  

подключения к БД,

\c <имя БД>

вывода списка таблиц,

\dtS 

вывода описания содержимого таблиц,

\dS+

выхода из psql.

\q


***
Задача 2
---
Используя psql, создайте БД test_database.

![Снимок303](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/9bd7e82f-8a5c-49d2-83ed-7ec88c391177)


Изучите бэкап БД.

Восстановите бэкап БД в test_database.

![Снимок304](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/9ce9181f-3737-4c53-be8e-b433148146ce)

Перейдите в управляющую консоль psql внутри контейнера.

![Снимок305](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/b7a84fb6-5276-4585-8f8d-c43b5c4fa20d)

Подключитесь к восстановленной БД и проведите операцию ANALYZE для сбора статистики по таблице.

![Снимок306](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/af5d9a88-b1a0-499e-9169-f4e5b328fc16)


Используя таблицу pg_stats, найдите столбец таблицы orders с наибольшим средним значением размера элементов в байтах.

![Снимок307](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/c4d3aa88-71c8-432d-960f-09d01a683b56)
***

Задача 3
---
Архитектор и администратор БД выяснили, что ваша таблица orders разрослась до невиданных размеров и поиск по ней занимает долгое время. Вам как успешному выпускнику курсов DevOps в Нетологии предложили провести разбиение таблицы на 2: шардировать на orders_1 - price>499 и orders_2 - price<=499.

Предложите SQL-транзакцию для проведения этой операции.

Выполнено шардирование таблицы orders на две таблицы orders_1 и orders_2, разделенные по значению цены. Затем оригинальная таблица orders будет удалена.

![Снимок308](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/a3e49553-6da4-43b7-b047-6d8c9196d98f)

Можно ли было изначально исключить ручное разбиение при проектировании таблицы orders?

Да, можно было изначально исключить ручное разбиение при проектировании таблицы orders. PostgreSQL поддерживает партицирование таблиц, которое позволяет автоматически разделить большую таблицу на меньшие подтаблицы или партиции. Это может быть особенно полезно для больших таблиц и может улучшить производительность запросов и обслуживания данных.

***
Задача 4
---

Используя утилиту pg_dump, создайте бекап БД test_database.

![Снимок309](https://github.com/AlexanderSchelokov/devops-netology/assets/121572590/3bfba172-85f6-4b6d-a849-2ac47417dd8b)


Как бы вы доработали бэкап-файл, чтобы добавить уникальность значения столбца title для таблиц test_database?

Присвоить столбцу  title  уникальные значения UNIQUE

***
