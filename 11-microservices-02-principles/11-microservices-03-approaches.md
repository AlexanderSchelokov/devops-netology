Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры. Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

Задача 1: Обеспечить разработку

Предложите решение для обеспечения процесса разработки: хранение исходного кода, непрерывная интеграция и непрерывная поставка. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:

облачная система;

система контроля версий Git;

репозиторий на каждый сервис;

запуск сборки по событию из системы контроля версий;

запуск сборки по кнопке с указанием параметров;

возможность привязать настройки к каждой сборке;

возможность создания шаблонов для различных конфигураций сборок;

возможность безопасного хранения секретных данных (пароли, ключи доступа);

несколько конфигураций для сборки из одного репозитория;

кастомные шаги при сборке;

собственные докер-образы для сборки проектов;

возможность развернуть агентов сборки на собственных серверах;

возможность параллельного запуска нескольких сборок;

возможность параллельного запуска тестов.

Обоснуйте свой выбор.

**Ответ**

Для обеспечения процесса разработки, хранения исходного кода, непрерывной интеграции и непрерывной поставки, я бы предложил использовать комбинацию следующих инструментов:

GitHub: Это облачная система контроля версий Git, которая позволяет создавать отдельный репозиторий для каждого сервиса. GitHub предоставляет функциональность для запуска сборки по событию из системы контроля версий (например, при коммите в определенную ветку).

Jenkins: Это инструмент для непрерывной интеграции и непрерывной поставки. Jenkins позволяет запускать сборку по кнопке с указанием параметров, привязывать настройки к каждой сборке, создавать шаблоны для различных конфигураций сборок и предоставляет возможность параллельного запуска нескольких сборок4. Jenkins также поддерживает кастомные шаги при сборке и использование собственных докер-образов для сборки проектов.

Docker: Docker позволяет создавать и использовать собственные докер-образы для сборки проектов. Это обеспечивает консистентность среды сборки между различными стадиями разработки.

Vault by HashiCorp: Это инструмент для безопасного хранения и управления секретами, такими как пароли, ключи доступа и т.д. Vault обеспечивает шифрование данных в ресте и в транзите, что обеспечивает высокий уровень безопасности.

Selenium Grid: Это инструмент для параллельного запуска тестов. Selenium Grid позволяет запускать тесты на различных машинах и браузерах одновременно, что ускоряет процесс тестирования.

Обоснование выбора: Эти инструменты вместе обеспечивают полный цикл разработки, от хранения кода до непрерывной интеграции, тестирования и поставки. Они широко используются в индустрии, имеют большое сообщество и хорошую поддержку. Кроме того, они предлагают гибкость и масштабируемость, что делает их подходящими для проектов любого размера.

---

Задача 2: Логи

Предложите решение для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:

сбор логов в центральное хранилище со всех хостов, обслуживающих систему;

минимальные требования к приложениям, сбор логов из stdout;

гарантированная доставка логов до центрального хранилища;

обеспечение поиска и фильтрации по записям логов;

обеспечение пользовательского интерфейса с возможностью предоставления доступа разработчикам для поиска по записям логов;

возможность дать ссылку на сохранённый поиск по записям логов.

Обоснуйте свой выбор.

**Ответ**

Для решения этой задачи я бы предложил использовать комбинацию нескольких инструментов, которые вместе обеспечат надежный и эффективный сбор, хранение и анализ логов в микросервисной архитектуре.

Fluentd или Fluent Bit: Эти инструменты можно использовать для сбора логов из stdout и других источников на каждом хосте. Они легко интегрируются с большинством платформ и приложений, обеспечивая гибкость и надежность при сборе логов.

Elasticsearch: Elasticsearch - это мощный инструмент для хранения и анализа данных, который может эффективно обрабатывать большие объемы логов. Он обеспечивает гарантированную доставку логов до центрального хранилища.

Kibana: Kibana - это веб-интерфейс для Elasticsearch, который обеспечивает возможности поиска, фильтрации и визуализации данных. Он также позволяет разработчикам получать доступ к записям логов и даже создавать ссылки на сохраненные поиски.

Эта комбинация инструментов, известная как EFK стек (Elasticsearch, Fluentd/Fluent Bit, Kibana), широко используется для обработки логов в микросервисных архитектурах. Она обеспечивает гибкость, масштабируемость и надежность, необходимые для эффективного управления логами в сложных распределенных системах.

Обоснование выбора: EFK стек выбран из-за его гибкости, масштабируемости и способности обрабатывать большие объемы данных. Fluentd и Fluent Bit обеспечивают гибкость при сборе логов, Elasticsearch обеспечивает мощные возможности поиска и анализа, а Kibana предлагает интуитивно понятный интерфейс для визуализации и исследования данных. Вместе они образуют мощное решение для управления логами в микросервисной архитектуре.

---

Задача 3: Мониторинг

Предложите решение для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре. Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:

сбор метрик со всех хостов, обслуживающих систему;

сбор метрик состояния ресурсов хостов: CPU, RAM, HDD, Network;

сбор метрик потребляемых ресурсов для каждого сервиса: CPU, RAM, HDD, Network;

сбор метрик, специфичных для каждого сервиса;

пользовательский интерфейс с возможностью делать запросы и агрегировать информацию;

пользовательский интерфейс с возможностью настраивать различные панели для отслеживания состояния системы.

Обоснуйте свой выбор.

**Ответ**

Для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре можно использовать комбинацию нескольких инструментов. 

Prometheus: Это система мониторинга и сбора метрик, которая может собирать метрики со всех хостов, обслуживающих систему. Prometheus поддерживает множество экспортеров, которые могут собирать метрики состояния ресурсов хостов (CPU, RAM, HDD, Network) и метрики, специфичные для каждого сервиса.

Metricbeat: Это легкий отправитель данных, который после установки на сервер периодически собирает статистику CPU и памяти (глобально и по отдельным процессам), а потом передает эти данные в Elasticsearch. Он может быть использован для сбора метрик потребляемых ресурсов для каждого сервиса (CPU, RAM, HDD, Network).

Grafana: Grafana - это мощный инструмент для визуализации данных, который может быть использован в качестве пользовательского интерфейса. Он позволяет делать запросы и агрегировать информацию, а также настраивать различные панели для отслеживания состояния системы.

Все эти инструменты могут быть интегрированы вместе для создания полноценной системы мониторинга. Prometheus и Metricbeat собирают метрики с хостов и сервисов, а Grafana используется для визуализации этих данных и предоставления пользовательского интерфейса для анализа метрик.
